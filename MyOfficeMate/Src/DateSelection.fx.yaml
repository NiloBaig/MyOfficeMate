DateSelection As screen:
    Fill: =Dashboard.Fill
    Height: =Max(App.Height, App.DesignHeight)
    LoadingSpinnerColor: =RGBA(3, 121, 137, 1)
    OnVisible: |
        =Set(resetcheckbox, true);
        Set(resetcheckbox, false);
    Width: =Max(App.Width, App.DesignWidth)

    bgRounded_1 As htmlViewer:
        Height: =635
        HtmlText: |-
            ="<div style='border-radius:10%;border-top-left-radius:10%;height:600px;width:100%;background-color:#FCFCFC'></div>"
        Width: =618
        X: =10
        Y: =118
        ZIndex: =3

    Calendar_1 As Calendar:
        BorderRadius: =1
        Height: =552
        SelectedDateFill: =RGBA(135, 78, 181, 1)
        SelectRange: =true
        Width: =593
        X: =22
        Y: =138
        ZIndex: =4

    lblSelectDate As label:
        Align: =Align.Center
        BorderColor: =RGBA(69, 186, 184, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FontWeight: =FontWeight.Bold
        Height: =118
        Size: =32
        Text: ="Select a Date"
        Width: =640
        ZIndex: =7

    lblSelectTimeSlot As label:
        Align: =Align.Center
        BorderColor: =RGBA(69, 186, 184, 1)
        Color: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =70
        Size: =24
        Text: ="Select a Time Slot"
        Width: =640
        Y: =736
        ZIndex: =8

    ddTimeFrom As dropdown:
        AccessibleLabel: ="Start Time"
        BorderColor: =RGBA(135, 78, 181, 1)
        BorderThickness: =1
        ChevronBackground: |-
            =ColorValue("#874EB5")
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronFill: =Color.White
        ChevronHoverBackground: |-
            =ColorValue("#874EB5")
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        Color: =If(varTheme = "Dark",Color.White, RGBA(0, 0, 0, 1))
        Default: |-
            =Text("9:00 AM")
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =If(varTheme="Dark",ColorValue("#2A2B33"), RGBA(255, 255, 255, 1))
        Height: =66
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =Color.LightGray
        Items: |
            =With(
                { Interval: 60 },
                ForAll(
                    Sequence(10),
                    Text(
                        Time(
                            6 + Value - 1,
                            0,
                            0
                        ),
                        "[$-en-US]h:mm AM/PM"  // Force the English (United States) format
                    )
                )
            )
        OnChange: =
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(109, 49, 162, 1)
        SelectionFill: =RGBA(109, 49, 162, 1)
        Size: =21
        Width: =190
        X: =63
        Y: =813
        ZIndex: =9

    lblTo As label:
        Align: =Align.Center
        BorderColor: =RGBA(69, 186, 184, 1)
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Height: =66
        Size: =21
        Text: ="to"
        Width: =80
        X: =259
        Y: =813
        ZIndex: =10

    ddTimeTo As dropdown:
        AccessibleLabel: ="End Time"
        BorderColor: =RGBA(135, 78, 181, 1)
        BorderThickness: =1
        ChevronBackground: |-
            =ColorValue("#874EB5")
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronFill: =Color.White
        ChevronHoverBackground: |-
            =ColorValue("#874EB5")
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        Color: =If(varTheme = "Dark",Color.White, RGBA(0, 0, 0, 1))
        Default: |-
            =Text("5:00 PM")
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =If(varTheme="Dark",ColorValue("#2A2B33"), RGBA(255, 255, 255, 1))
        Height: =66
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =Color.LightGray
        Items: |-
            =With(
                {Interval: 60},
                ForAll(
                    Sequence(10),
                    Text(
                        Time(
                            9 + Value - 1,
                            0,
                            0
                        ),
                        "[$-en-US]h:mm AM/PM"
                    )
                )
            )
        OnChange: =
        OnSelect: |-
            ="05:00 PM"
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(109, 49, 162, 1)
        SelectionFill: =RGBA(109, 49, 162, 1)
        Size: =21
        Width: =190
        X: =347
        Y: =813
        ZIndex: =11

    Tabs_5 As Tabs:
        FontColor: =If(varTheme="Dark",Color.White, RGBA(0, 0, 0, 1))
        IconColor: |-
            =ColorValue("#874EB5")
        Items: |-
            =Table(
                {
                    Name: "Home",
                    Icon: Icon.DetailList,
                    Page: Dashboard,        
                    Visible:true
                },
                {
                    Name: "Office Mates",
                    Icon: Icon.Person,
                    Page: MyAppts_tab,
                    Visible:true
                },
                {
                    Name: "Book",
                    Icon: Icon.Add,
                    Page: DateSelection,
                    Visible:true
                }
            )
        Y: =1016
        ZIndex: =12

    Arrow1 As arrow.backArrow:
        BorderColor: =RGBA(69, 186, 184, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(255, 255, 255, 1)
        Height: =60
        OnSelect: |-
            =Reset(Calendar_1);
            Reset(ddTimeTo);  
            Reset(ddTimeFrom);
            Back();
        Width: =60
        X: =22
        Y: =29
        ZIndex: =13

    grpHeader As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =13

        Image2_1 As image:
            BorderColor: =RGBA(69, 186, 184, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Height: =150
            Image: =abstractBackground
            ImagePosition: =ImagePosition.Fill
            Width: =640
            ZIndex: =1

        Rectangle2 As rectangle:
            BorderColor: =RGBA(69, 186, 184, 1)
            Fill: =RGBA(135, 78, 181, 0.65)
            Height: =150
            Width: =640
            ZIndex: =2

    Button1_4 As button:
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(135, 78, 181, 1)
        FontWeight: =FontWeight.Semibold
        Height: =61
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(Self.Fill, -20%)
        OnSelect: |-
            =Set(
                selectedDate,
                Calendar_1.StartDate
            );
            Set(
                selectedEndDate,
                Calendar_1.EndDate
            );
            Set(
                startTime,
                DateTimeValue(
                    Text(
                        selectedDate,
                        DateTimeFormat.ShortDate
                    ) & " " & ddTimeFrom.Selected.Value
                )
            );
            Set(
                endTime,
                If(
                    DateValue(
                        Text(
                            selectedEndDate,
                            DateTimeFormat.ShortDate
                        )
                    ) < DateValue(
                        Text(
                            selectedDate,
                            DateTimeFormat.ShortDate
                        )
                    ),
                    DateTimeValue(
                        Text(
                            selectedDate,
                            DateTimeFormat.ShortDate
                        ) & " " & ddTimeTo.Selected.Value
                    ),
                    DateTimeValue(
                        Text(
                            selectedEndDate,
                            DateTimeFormat.ShortDate
                        ) & " " & ddTimeTo.Selected.Value
                    )
                )
            );
            ClearCollect(
                col_Reservations,
                Filter(
                    Presence,
                    Or(
                        And(
                            'Check Out From' >= startTime,
                            Or(
                                'Check Out To' <= endTime,
                                'Check Out From' < endTime
                            )
                        ),
                        And(
                            'Check Out To' > startTime,
                            Or(
                                'Check Out To' <= endTime,
                                'Check Out From' < endTime
                            )
                        )
                    )
                )
            );
            Switch(
                Calendar_1.SelectRange,
                true,
                If(
                    false && false,
                    Notify(
                        "You must select a date and time to continue",
                        NotificationType.Warning
                    ),
                    Navigate(Confirm)
                ),
                false,
                If(
                    false && false,
                    Notify(
                        "You must select a date and time to continue",
                        NotificationType.Warning
                    ),
                    endTime <= startTime,
                    Notify(
                        "End time can't be earlier than start time. Please correct to continue.",
                        NotificationType.Warning
                    ),
                    Navigate(Confirm)
                )
            )
        RadiusBottomLeft: =60
        RadiusBottomRight: =60
        RadiusTopLeft: =60
        RadiusTopRight: =60
        Size: =21
        Text: ="CONTINUE"
        Width: =450
        X: =95
        Y: =917
        ZIndex: =14

